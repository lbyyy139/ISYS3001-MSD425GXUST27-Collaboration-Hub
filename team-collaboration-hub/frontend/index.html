<!DOCTYPE html>
<html>
<head>
    <title>团队协作中心</title>
    <style>
        body { font-family: Arial; margin: 20px; background: white; }
        .page { display: none; }
        .active { display: block; }
        .btn { padding: 8px 15px; margin: 5px; cursor: pointer; }
        .project { padding: 10px; margin: 5px 0; background: #f0f0f0; cursor: pointer; }
        .column { width: 30%; float: left; padding: 10px; border: 1px solid #ccc; margin: 5px; min-height: 300px; }
        .task { background: white; padding: 8px; margin: 5px 0; border: 1px solid #ddd; cursor: move; }
        .clear { clear: both; }
    </style>
</head>
<body>
    <!-- 登录页面 -->
    <div id="loginPage" class="page active">
        <h2>团队协作中心</h2>
        <div>
            <input type="text" id="username" placeholder="用户名" style="padding: 8px; margin: 5px; width: 200px;"><br>
            <input type="password" id="password" placeholder="密码" style="padding: 8px; margin: 5px; width: 200px;"><br>
            <button class="btn" onclick="login()">登录</button>
            <button class="btn" onclick="demoLogin()">演示登录</button>
        </div>
    </div>

    <!-- 主页面 -->
    <div id="mainPage" class="page">
        <div style="background: #007bff; color: white; padding: 10px;">
            <span>团队协作中心</span>
            <button class="btn" onclick="logout()" style="float: right;">退出</button>
        </div>

        <div style="padding: 20px;">
            <!-- 项目列表 -->
            <div style="width: 200px; float: left;">
                <h3>项目列表</h3>
                <button class="btn" onclick="addProject()">新建项目</button>
                <div id="projectList"></div>
            </div>

            <!-- 任务看板 -->
            <div style="margin-left: 220px;">
                <h3 id="boardTitle">选择项目查看任务</h3>
                <button class="btn" onclick="addTask()">新建任务</button>
                
                <div class="column">
                    <h4>待办</h4>
                    <div id="todoColumn" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="column">
                    <h4>进行中</h4>
                    <div id="progressColumn" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="column">
                    <h4>完成</h4>
                    <div id="doneColumn" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
    </div>

    <script>
        // 数据
        let projects = [
            { id: 1, name: '项目A' },
            { id: 2, name: '项目B' }
        ];
        
        let tasks = [
            { id: 1, title: '任务1', projectId: 1, status: 'todo' },
            { id: 2, title: '任务2', projectId: 1, status: 'progress' },
            { id: 3, title: '任务3', projectId: 1, status: 'done' }
        ];

        let currentProjectId = null;

        // 页面切换
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
        }

        // 登录
        function login() {
            showPage('mainPage');
            renderProjects();
        }

        function demoLogin() {
            showPage('mainPage');
            renderProjects();
        }

        // 退出
        function logout() {
            showPage('loginPage');
        }

        // 项目管理
        function renderProjects() {
            const projectList = document.getElementById('projectList');
            projectList.innerHTML = '';
            projects.forEach(project => {
                const div = document.createElement('div');
                div.className = 'project';
                div.textContent = project.name;
                div.onclick = () => selectProject(project.id);
                projectList.appendChild(div);
            });
        }

        function addProject() {
            const name = prompt('输入项目名称:');
            if (name) {
                projects.push({ id: Date.now(), name });
                renderProjects();
            }
        }

        function selectProject(projectId) {
            currentProjectId = projectId;
            document.getElementById('boardTitle').textContent = projects.find(p => p.id === projectId).name + ' - 任务看板';
            renderTasks();
        }

        // 任务管理
        function renderTasks() {
            if (!currentProjectId) return;
            
            const projectTasks = tasks.filter(task => task.projectId === currentProjectId);
            
            document.getElementById('todoColumn').innerHTML = '';
            document.getElementById('progressColumn').innerHTML = '';
            document.getElementById('doneColumn').innerHTML = '';

            projectTasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.className = 'task';
                taskElement.draggable = true;
                taskElement.id = 'task-' + task.id;
                taskElement.ondragstart = drag;
                taskElement.innerHTML = `
                    ${task.title}
                    <button onclick="deleteTask(${task.id})" style="float: right; font-size: 12px;">删除</button>
                `;

                if (task.status === 'todo') document.getElementById('todoColumn').appendChild(taskElement);
                else if (task.status === 'progress') document.getElementById('progressColumn').appendChild(taskElement);
                else if (task.status === 'done') document.getElementById('doneColumn').appendChild(taskElement);
            });
        }

        function addTask() {
            if (!currentProjectId) {
                alert('请先选择项目');
                return;
            }
            const title = prompt('输入任务标题:');
            if (title) {
                tasks.push({
                    id: Date.now(),
                    title,
                    projectId: currentProjectId,
                    status: 'todo'
                });
                renderTasks();
            }
        }

        function deleteTask(taskId) {
            if (confirm('确定删除?')) {
                tasks = tasks.filter(task => task.id !== taskId);
                renderTasks();
            }
        }

        // 拖拽功能
        function allowDrop(ev) { ev.preventDefault(); }
        function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); }
        function drop(ev) {
            ev.preventDefault();
            const taskId = parseInt(ev.dataTransfer.getData("text").split('-')[1]);
            const task = tasks.find(t => t.id === taskId);
            
            let newStatus = 'todo';
            if (ev.target.id === 'progressColumn' || ev.target.parentNode.id === 'progressColumn') newStatus = 'progress';
            else if (ev.target.id === 'doneColumn' || ev.target.parentNode.id === 'doneColumn') newStatus = 'done';
            
            if (task) {
                task.status = newStatus;
                renderTasks();
            }
        }

        // 初始化
        renderProjects();
    </script>
</body>
</html>